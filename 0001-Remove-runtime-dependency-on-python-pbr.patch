From 7a03cf04a8960346fa88ea9fe5fd3ba67dc036a7 Mon Sep 17 00:00:00 2001
From: Jakub Ruzicka <jruzicka@redhat.com>
Date: Tue, 23 Jul 2013 16:28:21 +0200
Subject: [PATCH] Remove runtime dependency on python-pbr.

---
 requirements.txt       |  3 ---
 setup.py               |  1 -
 swiftclient/version.py | 17 +++++++++++++++--
 test-requirements.txt  | 12 ------------
 4 files changed, 15 insertions(+), 18 deletions(-)
 delete mode 100644 requirements.txt
 delete mode 100644 test-requirements.txt

diff --git a/requirements.txt b/requirements.txt
deleted file mode 100644
index 21115e0..0000000
--- a/requirements.txt
+++ /dev/null
@@ -1,3 +0,0 @@
-d2to1>=0.2.10,<0.3
-pbr>=0.5,<0.6
-simplejson>=2.0.9
diff --git a/setup.py b/setup.py
index 59a0090..990f50d 100644
--- a/setup.py
+++ b/setup.py
@@ -17,5 +17,4 @@
 import setuptools
 
 setuptools.setup(
-    setup_requires=['d2to1', 'pbr'],
     d2to1=True)
diff --git a/swiftclient/version.py b/swiftclient/version.py
index 7bb5d18..bb908b8 100644
--- a/swiftclient/version.py
+++ b/swiftclient/version.py
@@ -14,6 +14,19 @@
 #    License for the specific language governing permissions and limitations
 #    under the License.
 
-from pbr import version as pbr_version
+class VersionInfo(object):
+    """
+    Emulate pbr VersionInfo to get rid of runtime dependency on python-pbr.
+    """
+    version = "REDHATSWIFTCLIENTVERSION"
 
-version_info = pbr_version.VersionInfo('python-swiftclient')
+    def release_string(self):
+        return self.version
+
+    def version_string(self):
+        return self.version
+
+    def cached_version_string(self, prefix=""):
+        return "%s%s" % (prefix, self.version)
+
+version_info = VersionInfo()
diff --git a/test-requirements.txt b/test-requirements.txt
deleted file mode 100644
index 223dcf4..0000000
--- a/test-requirements.txt
+++ /dev/null
@@ -1,12 +0,0 @@
-# Install bounded pep8/pyflakes first, then let flake8 install
-pep8==1.4.5
-pyflakes==0.7.2
-flake8==2.0
-
-coverage
-discover
-mock>=0.8.0
-python-keystoneclient
-sphinx>=1.1.2
-testrepository>=0.0.13
-testtools>=0.9.22
