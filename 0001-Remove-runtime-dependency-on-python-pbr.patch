From de38f0abc3a6ebf7426d88f5f2317e3b9175cc62 Mon Sep 17 00:00:00 2001
From: Jakub Ruzicka <jruzicka@redhat.com>
Date: Tue, 23 Jul 2013 16:28:21 +0200
Subject: [PATCH] Remove runtime dependency on python-pbr

---
 requirements.txt       |  2 --
 setup.py               |  1 -
 swiftclient/version.py | 17 +++++++++++++++--
 test-requirements.txt  |  9 ---------
 4 files changed, 15 insertions(+), 14 deletions(-)
 delete mode 100644 requirements.txt
 delete mode 100644 test-requirements.txt

diff --git a/requirements.txt b/requirements.txt
deleted file mode 100644
index 42104ec..0000000
--- a/requirements.txt
+++ /dev/null
@@ -1,2 +0,0 @@
-pbr>=0.5.21,<1.0
-simplejson>=2.0.9
diff --git a/setup.py b/setup.py
index 70c2b3f..afab729 100644
--- a/setup.py
+++ b/setup.py
@@ -18,5 +18,4 @@
 import setuptools
 
 setuptools.setup(
-    setup_requires=['pbr'],
     pbr=True)
diff --git a/swiftclient/version.py b/swiftclient/version.py
index 7bb5d18..bb908b8 100644
--- a/swiftclient/version.py
+++ b/swiftclient/version.py
@@ -14,6 +14,19 @@
 #    License for the specific language governing permissions and limitations
 #    under the License.
 
-from pbr import version as pbr_version
+class VersionInfo(object):
+    """
+    Emulate pbr VersionInfo to get rid of runtime dependency on python-pbr.
+    """
+    version = "REDHATSWIFTCLIENTVERSION"
 
-version_info = pbr_version.VersionInfo('python-swiftclient')
+    def release_string(self):
+        return self.version
+
+    def version_string(self):
+        return self.version
+
+    def cached_version_string(self, prefix=""):
+        return "%s%s" % (prefix, self.version)
+
+version_info = VersionInfo()
diff --git a/test-requirements.txt b/test-requirements.txt
deleted file mode 100644
index 5b78b5f..0000000
--- a/test-requirements.txt
+++ /dev/null
@@ -1,9 +0,0 @@
-hacking>=0.5.6,<0.8
-
-coverage>=3.6
-discover
-mock>=1.0
-python-keystoneclient>=0.3.2
-sphinx>=1.1.2
-testrepository>=0.0.17
-testtools>=0.9.32
